<!DOCTYPE HTML>
<html><head><meta charset="UTF-8"><title>msgame_v3.5</title><script type="text/javascript" src="elm-runtime.js"></script><script type="text/javascript">Elm.Main = Elm.Main || {};
Elm.Main.make = function (_elm) {
   _elm.Main = _elm.Main || {};
   if (_elm.Main.values)
   return _elm.Main.values;
   var N = Elm.Native,
   _N = N.Utils.make(_elm),
   _L = N.List.make(_elm),
   _E = N.Error.make(_elm),
   _J = N.JavaScript.make(_elm),
   $moduleName = "Main";
   var Text = Elm.Text.make(_elm);
   var Text = Elm.Text.make(_elm);
   var Basics = Elm.Basics.make(_elm);
   var Signal = Elm.Signal.make(_elm);
   var List = Elm.List.make(_elm);
   var Maybe = Elm.Maybe.make(_elm);
   var Time = Elm.Time.make(_elm);
   var Prelude = Elm.Prelude.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Element = Elm.Graphics.Element.make(_elm);
   var Color = Elm.Color.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Collage = Elm.Graphics.Collage.make(_elm);
   var Keyboard = Elm.Keyboard.make(_elm);
   var Window = Elm.Window.make(_elm);
   var Touch = Elm.Touch.make(_elm);
   var Dict = Elm.Dict.make(_elm);
   var Transform2D = Elm.Transform2D.make(_elm);
   var _op = {};
   var unitGeneration = 1.0e-2;
   var transparentPaint = Graphics.Collage.filled(A4(Color.rgba,
   0,
   0,
   0,
   0));
   var transformP = F3(function (w,
   h,
   _v0) {
      return function () {
         return {_: {}
                ,x: _v0.x - Basics.toFloat(w) / 2
                ,y: Basics.toFloat(h) / 2 - _v0.y};
      }();
   });
   var toMyTouch = function (t) {
      return {_: {}
             ,dst: {_: {}
                   ,x: Basics.toFloat(t.x)
                   ,y: Basics.toFloat(t.y)}
             ,src: {_: {}
                   ,x: Basics.toFloat(t.x0)
                   ,y: Basics.toFloat(t.y0)}};
   };
   var stepArrows = F4(function (arrows,
   prevSelected,
   newSelected,
   stopCommand) {
      return function () {
         var sendCommand = function () {
            var _v2 = {ctor: "_Tuple2"
                      ,_0: prevSelected
                      ,_1: newSelected};
            switch (_v2.ctor)
            {case "_Tuple2":
               switch (_v2._0.ctor)
                 {case "Just":
                    switch (_v2._1.ctor)
                      {case "Just":
                         return _N.eq(_v2._0._0,
                           _v2._1._0) ? Maybe.Nothing : Maybe.Just({ctor: "_Tuple2"
                                                                   ,_0: _v2._0._0
                                                                   ,_1: _v2._1._0});}
                      break;}
                 break;}
            return Maybe.Nothing;
         }();
         var removeStartingBy = function (a1) {
            return List.filter(function (_v7) {
               return function () {
                  switch (_v7.ctor)
                  {case "_Tuple2":
                     return Basics.not(_N.eq(a1,
                       _v7._0));}
                  _E.Case($moduleName,
                  "on line 163, column 49 to 62");
               }();
            });
         };
         var remove = function (a) {
            return List.filter(function (b) {
               return Basics.not(_N.eq(a,
               b));
            });
         };
         var applyStop = function () {
            switch (stopCommand.ctor)
            {case "Just":
               switch (stopCommand._0.ctor)
                 {case "_Tuple2":
                    return function ($) {
                         return remove({ctor: "_Tuple2"
                                       ,_0: stopCommand._0._0
                                       ,_1: stopCommand._0._1})(remove({ctor: "_Tuple2"
                                                                       ,_0: stopCommand._0._1
                                                                       ,_1: stopCommand._0._0})($));
                      };}
                 break;
               case "Nothing":
               return Basics.id;}
            _E.Case($moduleName,
            "between lines 170 and 173");
         }();
         var applyCommand = function () {
            switch (sendCommand.ctor)
            {case "Just":
               switch (sendCommand._0.ctor)
                 {case "_Tuple2":
                    return function ($) {
                         return F2(function (x,y) {
                            return {ctor: "::"
                                   ,_0: x
                                   ,_1: y};
                         })({ctor: "_Tuple2"
                            ,_0: sendCommand._0._0
                            ,_1: sendCommand._0._1})(removeStartingBy(sendCommand._0._0)(remove({ctor: "_Tuple2"
                                                                                                ,_0: sendCommand._0._1
                                                                                                ,_1: sendCommand._0._0})($)));
                      };}
                 break;
               case "Nothing":
               return Basics.id;}
            _E.Case($moduleName,
            "between lines 166 and 169");
         }();
         return applyStop(applyCommand(arrows));
      }();
   });
   var sqr = function (a) {
      return a * a;
   };
   var selectorSize = 1.6;
   var safeHead = function (xs) {
      return function () {
         switch (xs.ctor)
         {case "::":
            return Maybe.Just(xs._0);
            case "[]":
            return Maybe.Nothing;}
         _E.Case($moduleName,
         "between lines 81 and 83");
      }();
   };
   var roads = _J.toList([{ctor: "_Tuple2"
                          ,_0: 1
                          ,_1: 2}
                         ,{ctor: "_Tuple2",_0: 2,_1: 3}
                         ,{ctor: "_Tuple2",_0: 1,_1: 4}
                         ,{ctor: "_Tuple2",_0: 3,_1: 5}
                         ,{ctor: "_Tuple2"
                          ,_0: 4
                          ,_1: 5}]);
   var roadExists = function (_v22) {
      return function () {
         switch (_v22.ctor)
         {case "_Tuple2":
            return function () {
                 var f = F2(function (_v26,
                 alreadyFound) {
                    return function () {
                       switch (_v26.ctor)
                       {case "_Tuple2":
                          return alreadyFound || (_N.eq({ctor: "_Tuple2"
                                                        ,_0: _v22._0
                                                        ,_1: _v22._1},
                            {ctor: "_Tuple2"
                            ,_0: _v26._0
                            ,_1: _v26._1}) || _N.eq({ctor: "_Tuple2"
                                                    ,_0: _v22._0
                                                    ,_1: _v22._1},
                            {ctor: "_Tuple2"
                            ,_0: _v26._1
                            ,_1: _v26._0}));}
                       _E.Case($moduleName,
                       "between lines 108 and 110");
                    }();
                 });
                 return A3(List.foldl,
                 f,
                 false,
                 roads);
              }();}
         _E.Case($moduleName,
         "between lines 108 and 111");
      }();
   };
   var mulP = F2(function (c,p) {
      return {_: {}
             ,x: p.x * c
             ,y: p.y * c};
   });
   var moveRatio = 5.0e-3;
   var stepUnits = F2(function (units,
   arrows) {
      return function () {
         var unitsOf = function (city) {
            return A3(Dict.findWithDefault,
            0,
            city,
            units);
         };
         var unitsToMove = function (_v30) {
            return function () {
               switch (_v30.ctor)
               {case "_Tuple2":
                  return F2(function (x,y) {
                       return x * y;
                    })(moveRatio)(unitsOf(_v30._0));}
               _E.Case($moduleName,
               "on line 192, column 32 to 61");
            }();
         };
         var start = Dict.empty;
         var accumulation = F2(function (_v34,
         dict) {
            return function () {
               switch (_v34.ctor)
               {case "_Tuple2":
                  return function () {
                       var units$ = unitsToMove({ctor: "_Tuple2"
                                                ,_0: _v34._0
                                                ,_1: _v34._1});
                       var prevUnitsOf = function (c) {
                          return A2(Dict.findWithDefault,
                          0,
                          c)(dict);
                       };
                       return A2(Dict.insert,
                       _v34._1,
                       prevUnitsOf(_v34._1) + units$)(A2(Dict.insert,
                       _v34._0,
                       prevUnitsOf(_v34._0) - units$)(dict));
                    }();}
               _E.Case($moduleName,
               "between lines 194 and 197");
            }();
         });
         var unitsToAddDict = A3(List.foldl,
         accumulation,
         start,
         arrows);
         var unitsToAdd = function (c) {
            return A2(Dict.findWithDefault,
            0,
            c)(unitsToAddDict);
         };
         var newUnits = function (city) {
            return {ctor: "_Tuple2"
                   ,_0: city
                   ,_1: unitsOf(city) + unitsToAdd(city) + unitGeneration};
         };
         return Dict.fromList(List.map(newUnits)(Dict.keys(units)));
      }();
   });
   var modF = F2(function (x,y) {
      return x - Basics.toFloat(Basics.floor(x / y)) * y;
   });
   var distance = F2(function (p1,
   p2) {
      return Basics.sqrt(sqr(p1.x - p2.x) + sqr(p1.y - p2.y));
   });
   var near = F3(function (d,
   p1,
   p2) {
      return _N.cmp(A2(distance,
      p1,
      p2),
      d) < 0;
   });
   var delta = A2(Signal._op["<~"],
   Time.inSeconds,
   Time.fps(35));
   var defaultGame = {_: {}
                     ,arrows: _J.toList([{ctor: "_Tuple2"
                                         ,_0: 1
                                         ,_1: 2}])
                     ,selectedCity: Maybe.Nothing
                     ,time: 0
                     ,units: Dict.fromList(_J.toList([{ctor: "_Tuple2"
                                                      ,_0: 1
                                                      ,_1: Basics.toFloat(50)}
                                                     ,{ctor: "_Tuple2"
                                                      ,_0: 2
                                                      ,_1: Basics.toFloat(60)}
                                                     ,{ctor: "_Tuple2"
                                                      ,_0: 3
                                                      ,_1: Basics.toFloat(20)}
                                                     ,{ctor: "_Tuple2"
                                                      ,_0: 4
                                                      ,_1: Basics.toFloat(10)}
                                                     ,{ctor: "_Tuple2"
                                                      ,_0: 5
                                                      ,_1: Basics.toFloat(30)}]))};
   var createTransform = F2(function (w,
   h) {
      return A6(Transform2D.matrix,
      1,
      0,
      0,
      -1,
      0 - Basics.toFloat(w) / 2,
      Basics.toFloat(h) / 2);
   });
   var transformElement = F3(function (w,
   h,
   element) {
      return function (el) {
         return A3(Graphics.Collage.collage,
         w,
         h,
         _J.toList([el]));
      }(Graphics.Collage.groupTransform(A2(createTransform,
      w,
      h))(_J.toList([Graphics.Collage.toForm(element)])));
   });
   var cityPositions = _J.toList([{ctor: "_Tuple2"
                                  ,_0: 1
                                  ,_1: {_: {},x: 150,y: 80}}
                                 ,{ctor: "_Tuple2"
                                  ,_0: 2
                                  ,_1: {_: {},x: 100,y: 200}}
                                 ,{ctor: "_Tuple2"
                                  ,_0: 3
                                  ,_1: {_: {},x: 250,y: 200}}
                                 ,{ctor: "_Tuple2"
                                  ,_0: 4
                                  ,_1: {_: {},x: 350,y: 80}}
                                 ,{ctor: "_Tuple2"
                                  ,_0: 5
                                  ,_1: {_: {},x: 400,y: 200}}]);
   var getCityPos = function (city) {
      return function (_v42) {
         return function () {
            switch (_v42.ctor)
            {case "_Tuple2":
               return _v42._1;}
            _E.Case($moduleName,
            "on line 97, column 17 to 18");
         }();
      }(List.head(List.filter(function (_v38) {
         return function () {
            switch (_v38.ctor)
            {case "_Tuple2":
               return _N.eq(_v38._0,city);}
            _E.Case($moduleName,
            "on line 95, column 25 to 34");
         }();
      })(cityPositions)));
   };
   var drawRoad = function (_v46) {
      return function () {
         switch (_v46.ctor)
         {case "_Tuple2":
            return function () {
                 var roadColor = A4(Color.rgba,
                 0,
                 0,
                 0,
                 0.1);
                 var posB = getCityPos(_v46._1);
                 var posA = getCityPos(_v46._0);
                 var line = A2(Graphics.Collage.segment,
                 {ctor: "_Tuple2"
                 ,_0: posA.x
                 ,_1: posA.y},
                 {ctor: "_Tuple2"
                 ,_0: posB.x
                 ,_1: posB.y});
                 return A2(Graphics.Collage.outlined,
                 _N.replace([["width",6]
                            ,["color",roadColor]],
                 Graphics.Collage.defaultLine),
                 line);
              }();}
         _E.Case($moduleName,
         "between lines 273 and 278");
      }();
   };
   var roadsForm = Graphics.Collage.group(A2(List.map,
   drawRoad,
   roads));
   var cityIds = Dict.keys(defaultGame.units);
   var cityD = 70;
   var cityR = cityD / 2;
   var cityNear = function (p) {
      return function () {
         var f = function (_v50) {
            return function () {
               switch (_v50.ctor)
               {case "_Tuple2": return A3(near,
                    cityR,
                    _v50._1,
                    p);}
               _E.Case($moduleName,
               "on line 115, column 20 to 36");
            }();
         };
         var matches = List.filter(f)(cityPositions);
         return function () {
            switch (matches.ctor)
            {case "::":
               switch (matches._0.ctor)
                 {case "_Tuple2":
                    return Maybe.Just(matches._0._0);}
                 break;
               case "[]":
               return Maybe.Nothing;}
            _E.Case($moduleName,
            "between lines 117 and 119");
         }();
      }();
   };
   var detectEndSelection = function (touches) {
      return function () {
         var touch = safeHead(touches);
         return function () {
            switch (touch.ctor)
            {case "Just":
               return cityNear(touch._0.dst);
               case "Nothing":
               return Maybe.Nothing;}
            _E.Case($moduleName,
            "between lines 139 and 140");
         }();
      }();
   };
   var detectStartSelection = function (touches) {
      return function () {
         var touch = safeHead(touches);
         return function () {
            switch (touch.ctor)
            {case "Just":
               return cityNear(touch._0.src);
               case "Nothing":
               return Maybe.Nothing;}
            _E.Case($moduleName,
            "between lines 132 and 134");
         }();
      }();
   };
   var stepSelection = F2(function (touches,
   prevSelection) {
      return function () {
         var touching = Basics.not(List.isEmpty(touches));
         var start = detectStartSelection(touches);
         var end = detectEndSelection(touches);
         return function () {
            var _v63 = {ctor: "_Tuple3"
                       ,_0: prevSelection
                       ,_1: end
                       ,_2: touching};
            switch (_v63.ctor)
            {case "_Tuple3":
               switch (_v63._0.ctor)
                 {case "Just":
                    switch (_v63._1.ctor)
                      {case "Just": switch (_v63._2)
                           {case true:
                              return roadExists({ctor: "_Tuple2"
                                                ,_0: _v63._0._0
                                                ,_1: _v63._1._0}) ? end : prevSelection;}
                           break;
                         case "Nothing": switch (_v63._2)
                           {case true:
                              return prevSelection;}
                           break;}
                      break;}
                 break;}
            return start;
         }();
      }();
   });
   var createGrad = F3(function (r,
   g,
   b) {
      return function () {
         var c = A3(Color.rgba,r,g,b);
         return Graphics.Collage.gradient(A3(Color.radial,
         {ctor: "_Tuple2",_0: 0,_1: 0},
         20,
         {ctor: "_Tuple2"
         ,_0: 0
         ,_1: 0})(cityD / 2 * selectorSize)(_J.toList([{ctor: "_Tuple2"
                                                       ,_0: 0
                                                       ,_1: c(0)}
                                                      ,{ctor: "_Tuple2"
                                                       ,_0: 0.5
                                                       ,_1: c(0.5)}
                                                      ,{ctor: "_Tuple2"
                                                       ,_0: 1
                                                       ,_1: c(0)}])));
      }();
   });
   var dstSelectPaint = A3(createGrad,
   255,
   1,
   136);
   var srcSelectPaint = A3(createGrad,
   155,
   223,
   211);
   var avg = F2(function (a,b) {
      return {_: {}
             ,x: (a.x + b.x) / 2
             ,y: (a.y + b.y) / 2};
   });
   var stopPositions = function () {
      var find = function (_v69) {
         return function () {
            switch (_v69.ctor)
            {case "_Tuple2":
               return {ctor: "_Tuple2"
                      ,_0: {ctor: "_Tuple2"
                           ,_0: _v69._0
                           ,_1: _v69._1}
                      ,_1: A2(avg,
                      getCityPos(_v69._0),
                      getCityPos(_v69._1))};}
            _E.Case($moduleName,
            "on line 70, column 22 to 63");
         }();
      };
      return List.map(find)(roads);
   }();
   var roadNear = function (p) {
      return function () {
         var f = function (_v73) {
            return function () {
               switch (_v73.ctor)
               {case "_Tuple2": return A3(near,
                    30,
                    _v73._1,
                    p);}
               _E.Case($moduleName,
               "on line 101, column 23 to 36");
            }();
         };
         var matches = List.filter(f)(stopPositions);
         return function () {
            switch (matches.ctor)
            {case "::":
               switch (matches._0.ctor)
                 {case "_Tuple2":
                    return Maybe.Just(matches._0._0);}
                 break;
               case "[]":
               return Maybe.Nothing;}
            _E.Case($moduleName,
            "between lines 103 and 105");
         }();
      }();
   };
   var detectStopCommand = function (touches) {
      return function () {
         var touch = safeHead(touches);
         return function () {
            switch (touch.ctor)
            {case "Just":
               return roadNear(touch._0.dst);
               case "Nothing":
               return Maybe.Nothing;}
            _E.Case($moduleName,
            "between lines 125 and 127");
         }();
      }();
   };
   var stepGame = F2(function (_v84,
   _v85) {
      return function () {
         return function () {
            return function () {
               var prevSelectedCity = _v85.selectedCity;
               var myTouches = A2(List.map,
               toMyTouch,
               _v84.touches);
               var newSelectedCity = A2(stepSelection,
               myTouches,
               prevSelectedCity);
               var stopCommand = Maybe.isNothing(_v85.selectedCity) ? detectStopCommand(myTouches) : Maybe.Nothing;
               return _N.replace([["arrows"
                                  ,A4(stepArrows,
                                  _v85.arrows,
                                  prevSelectedCity,
                                  newSelectedCity,
                                  stopCommand)]
                                 ,["selectedCity"
                                  ,newSelectedCity]
                                 ,["units"
                                  ,A2(stepUnits,
                                  _v85.units,
                                  _v85.arrows)]
                                 ,["time"
                                  ,_v85.time + _v84.delta]],
               _v85);
            }();
         }();
      }();
   });
   var addP = F2(function (a,b) {
      return {_: {}
             ,x: a.x + b.x
             ,y: a.y + b.y};
   });
   var drawArrow2 = F3(function (time,
   units,
   _v88) {
      return function () {
         switch (_v88.ctor)
         {case "_Tuple2":
            return function () {
                 var speed = 10;
                 var s = 15;
                 var n = 5;
                 var circleR = Basics.sqrt(A3(Dict.findWithDefault,
                 0,
                 _v88._0,
                 units)) / 3;
                 var drawPoint = function (_v92) {
                    return function () {
                       return Graphics.Collage.move({ctor: "_Tuple2"
                                                    ,_0: _v92.x
                                                    ,_1: _v92.y})(Graphics.Collage.filled(Color.green)(Graphics.Collage.circle(circleR)));
                    }();
                 };
                 var b = getCityPos(_v88._1);
                 var a = getCityPos(_v88._0);
                 var mid = A2(avg,a,b);
                 var v = {_: {}
                         ,x: b.x - a.x
                         ,y: b.y - a.y};
                 var l = Basics.sqrt(sqr(v.x) + sqr(v.y));
                 var d = l / n;
                 var dir = {_: {}
                           ,x: v.x / l
                           ,y: v.y / l};
                 var tri = Graphics.Collage.filled(Color.green)(Graphics.Collage.polygon(_J.toList([{ctor: "_Tuple2"
                                                                                                    ,_0: mid.x + dir.y * s
                                                                                                    ,_1: mid.y - dir.x * s}
                                                                                                   ,{ctor: "_Tuple2"
                                                                                                    ,_0: mid.x - dir.y * s
                                                                                                    ,_1: mid.y + dir.x * s}
                                                                                                   ,{ctor: "_Tuple2"
                                                                                                    ,_0: mid.x + dir.x * s
                                                                                                    ,_1: mid.y + dir.y * s}])));
                 var f = function (x) {
                    return addP(a)(A2(mulP,
                    x / (n - 1) * (l - d) + A2(modF,
                    time,
                    d / speed) * speed,
                    dir));
                 };
                 var centers = List.map(f)(_L.range(0,
                 n - 1));
                 return Graphics.Collage.group({ctor: "::"
                                               ,_0: tri
                                               ,_1: A2(List.map,
                                               drawPoint,
                                               centers)});
              }();}
         _E.Case($moduleName,
         "between lines 290 and 312");
      }();
   });
   var Source = {ctor: "Source"};
   var Point = F2(function (a,b) {
      return {_: {},x: a,y: b};
   });
   var None = {ctor: "None"};
   var MyTouch = F2(function (a,
   b) {
      return {_: {},dst: b,src: a};
   });
   var Input = F3(function (a,
   b,
   c) {
      return {_: {}
             ,delta: c
             ,space: b
             ,touches: a};
   });
   var input = A2(Signal.sampleOn,
   delta,
   A2(Signal._op["~"],
   A2(Signal._op["~"],
   A2(Signal._op["<~"],
   Input,
   Touch.touches),
   Keyboard.space),
   delta));
   var gameState = A3(Signal.foldp,
   stepGame,
   defaultGame,
   input);
   var Game = F4(function (a,
   b,
   c,
   d) {
      return {_: {}
             ,arrows: b
             ,selectedCity: c
             ,time: d
             ,units: a};
   });
   var Destination = {ctor: "Destination"};
   var drawCity$ = F3(function (position,
   units,
   selection) {
      return function () {
         var paint = function () {
            switch (selection.ctor)
            {case "Destination":
               return dstSelectPaint;
               case "None":
               return transparentPaint;
               case "Source":
               return srcSelectPaint;}
            _E.Case($moduleName,
            "between lines 318 and 322");
         }();
         var collageSize = Basics.round(cityD * selectorSize);
         return Graphics.Collage.move({ctor: "_Tuple2"
                                      ,_0: position.x
                                      ,_1: position.y})(Graphics.Collage.group(_J.toList([Graphics.Collage.filled(Color.white)(Graphics.Collage.circle(cityR))
                                                                                         ,Graphics.Collage.outlined(Graphics.Collage.solid(Color.green))(Graphics.Collage.circle(cityR))
                                                                                         ,Graphics.Collage.filled(Color.green)(Graphics.Collage.circle(Basics.sqrt(units)))
                                                                                         ,paint(Graphics.Collage.circle(cityR * selectorSize))])));
      }();
   });
   var drawCity = F3(function (units,
   selected,
   cityId) {
      return function () {
         var units$ = A3(Dict.findWithDefault,
         0,
         cityId,
         units);
         var selection = function () {
            switch (selected.ctor)
            {case "Just":
               return _N.eq(selected._0,
                 cityId) ? Source : None;
               case "Nothing": return None;}
            _E.Case($moduleName,
            "between lines 336 and 341");
         }();
         var position = getCityPos(cityId);
         return A3(drawCity$,
         position,
         units$,
         selection);
      }();
   });
   var drawCities = F2(function (units,
   selectedCity) {
      return List.map(A2(drawCity,
      units,
      selectedCity))(cityIds);
   });
   var display = F2(function (_v97,
   _v98) {
      return function () {
         return function () {
            switch (_v97.ctor)
            {case "_Tuple2":
               return A2(transformElement,
                 _v97._0,
                 _v97._1)(A2(Graphics.Collage.collage,
                 900,
                 500)({ctor: "::"
                      ,_0: roadsForm
                      ,_1: _L.append(A2(drawCities,
                      _v98.units,
                      _v98.selectedCity),
                      A2(List.map,
                      A2(drawArrow2,
                      _v98.time,
                      _v98.units),
                      _v98.arrows))}));}
            _E.Case($moduleName,
            "between lines 355 and 358");
         }();
      }();
   });
   var main = A3(Signal.lift2,
   display,
   Window.dimensions,
   gameState);
   _elm.Main.values = {_op: _op
                      ,delta: delta
                      ,input: input
                      ,cityPositions: cityPositions
                      ,cityIds: cityIds
                      ,roads: roads
                      ,defaultGame: defaultGame
                      ,stopPositions: stopPositions
                      ,safeHead: safeHead
                      ,sqr: sqr
                      ,distance: distance
                      ,near: near
                      ,addP: addP
                      ,mulP: mulP
                      ,avg: avg
                      ,getCityPos: getCityPos
                      ,roadNear: roadNear
                      ,roadExists: roadExists
                      ,cityNear: cityNear
                      ,detectStopCommand: detectStopCommand
                      ,detectStartSelection: detectStartSelection
                      ,detectEndSelection: detectEndSelection
                      ,stepSelection: stepSelection
                      ,stepArrows: stepArrows
                      ,toMyTouch: toMyTouch
                      ,moveRatio: moveRatio
                      ,unitGeneration: unitGeneration
                      ,stepUnits: stepUnits
                      ,stepGame: stepGame
                      ,gameState: gameState
                      ,srcSelectPaint: srcSelectPaint
                      ,dstSelectPaint: dstSelectPaint
                      ,transparentPaint: transparentPaint
                      ,selectorSize: selectorSize
                      ,cityD: cityD
                      ,cityR: cityR
                      ,createGrad: createGrad
                      ,createTransform: createTransform
                      ,transformP: transformP
                      ,drawRoad: drawRoad
                      ,roadsForm: roadsForm
                      ,modF: modF
                      ,drawArrow2: drawArrow2
                      ,drawCity$: drawCity$
                      ,drawCity: drawCity
                      ,drawCities: drawCities
                      ,transformElement: transformElement
                      ,display: display
                      ,main: main
                      ,Source: Source
                      ,Destination: Destination
                      ,None: None
                      ,Input: Input
                      ,Point: Point
                      ,Game: Game
                      ,MyTouch: MyTouch};
   return _elm.Main.values;
};</script></head><body><script type="text/javascript">Elm.fullscreen(Elm.Main)</script><noscript></noscript></body></html>